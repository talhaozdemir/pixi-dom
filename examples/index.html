<!DOCTYPE html>
<html>
  <head>
    <title>PIXI CSS</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        margin: 0;
        user-select: none;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
      }

      #pixi-content {
        background: #000000;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>

  <body>
    <script src="https://pixijs.download/dev/pixi.min.js"></script>
    <script src="../dist/pixi-css.js"></script>
    <script type="module">
      const app = new PIXI.Application();
      await app.init({ width: 800, height: 800, preference: "webgl" });
      document.body.appendChild(app.canvas);

      const htmlCont = new PIXI.CSS.HTMLContainer({
        debug: {
          enabled: true,
          color1: 0x92b7d1,
          color2: 0x2d86c4,
        },
        htmlContent: `
        <div class="grid">
            <div class="hud" style="grid-area: hud;">hud</div>
            <div class="skillBar" style="grid-area: skillBar;">skillBar</div>
            <div class="gameArea" style="grid-area: gameArea;">gameArea</div>
            <div class="adsArea" style="grid-area: adsArea;">adsArea</div>
        </div>`,
        cssContent: `
        .grid {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-areas: 
            "hud hud"
            "skillBar gameArea"
            "adsArea adsArea";
            grid-template-rows: 64px 1fr 64px;
            grid-template-columns: 1fr 6fr;
        }`,
      });
      app.stage.addChild(htmlCont);
      htmlCont.rootDiv.style.zIndex = -1;
      console.log(htmlCont);

      const hudWrapper = htmlCont.getWrapperByLabel("gameArea");

      const bunnyTexture = await PIXI.Assets.load("https://pixijs.com/assets/bunny.png");

      const sprite = PIXI.Sprite.from(bunnyTexture);
      sprite.anchor.set(0.5);
      sprite.tint = 0xffffff;
      sprite.baseWidth = sprite.texture.orig.width;
      sprite.baseHeight = sprite.texture.orig.height;
      hudWrapper.addChild(sprite);

      sprite.resizeData = {
        portrait: {
          location: {
            x: "center",
            y: "center",
          },
          offset: {
            unit: "self",
            x: 0,
            y: 0,
          },
          scale: {
            type: "relative",
            fit: "min",
            x: 0.25,
            y: 0.25,
          },
        },
        landscape: {
          location: {
            x: "center",
            y: "center",
          },
          offset: {
            unit: "self",
            x: 0,
            y: 0,
          },
          scale: {
            type: "relative",
            fit: "min",
            x: 0.4,
            y: 0.4,
          },
        },
      };

      // sprite.resize = (w, h) => {
      //   const wRatio = (w * 0.5) / sprite.texture.orig.width;
      //   const hRatio = (h * 0.5) / sprite.texture.orig.height;
      //   sprite.scale.set(Math.min(wRatio, hRatio));

      //   sprite.x = w / 2;
      //   sprite.y = h / 2;
      // };

      //   let elapsed = 0.0;
      //   app.ticker.add((ticker) => {
      //     elapsed += ticker.deltaTime;
      //     sprite.angle = Math.cos(elapsed / 50.0) * 100.0;
      //   });

      new PIXI.CSS.Responsive(app.renderer, app.stage);
    </script>
  </body>
</html>
